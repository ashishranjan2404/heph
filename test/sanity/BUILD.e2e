load("//test", "e2e_test")

e2e_test(
    name="sanity_echo",
    cmd="heph run //test/sanity:echo",
    expected_output="Hello world",
)

e2e_test(
    name="sanity_count-lorem",
    cmd="heph run //test/sanity:count-lorem",
    expected_output="69",
)

e2e_test(
    name="basic_query_sanity",
    cmd="heph query alltargets | grep '//test/sanity'",
    expected_output="""
//test/sanity:basic_query_sanity
//test/sanity:count-lorem
//test/sanity:custom-exit-code
//test/sanity:echo
//test/sanity:sanity_count-lorem
//test/sanity:sanity_echo
//test/sanity:sanity_exit-code
""".strip(),
)

e2e_test(
    name="sanity_exit-code",
    cmd="heph run //test/sanity:custom-exit-code",
    expected_failure=True,
    expected_exit_code=42,
)
